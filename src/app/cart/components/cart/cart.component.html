<div class="w1000">
  <h2 class="text-center">Cart</h2>

  <ng-template
    [ngIf]="cart.length"
    [ngIfThen]="table"
    [ngIfElse]="empty"
  ></ng-template>

  <ng-template #empty>
    <div class="text-center">Cart is empty</div>
  </ng-template>

  <ng-template #table>
    <table mat-table [dataSource]="itemsSource" class="mat-elevation-z8 w100">
      <ng-container matColumnDef="image">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <img src="{{ element.image }}" width="70" height="70" />
        </td>
      </ng-container>

      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef>Title</th>
        <td mat-cell *matCellDef="let element" class="short-text">
          {{ element.title }}
        </td>
      </ng-container>

      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef class="app-mat-table-text-center">
          Price
        </th>
        <td mat-cell *matCellDef="let element" class="text-center">
          {{ element.price | currency }}
        </td>
      </ng-container>

      <ng-container matColumnDef="itemTotal">
        <th mat-header-cell *matHeaderCellDef class="app-mat-table-text-center">
          Total
        </th>
        <td
          mat-cell
          *matCellDef="let element"
          class="text-center short-text cart-item-total-cell"
        >
          {{ element.amount * element.price | currency }}
        </td>
      </ng-container>

      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef class="app-mat-table-text-center">
          Amount
        </th>
        <td mat-cell *matCellDef="let element">
          <!-- <app-input-amount
              [(amount)]="element.amount">
            </app-input-amount> -->

          {{ element.amount }}
          <app-input-amount-accessor
            [(ngModel)]="element.amount"
            (ngModelChanged)="amountChanged(element.id, $event)"
            [ngModelOptions]="{ updateOn: 'blur' }"
          >
          </app-input-amount-accessor>
        </td>
      </ng-container>

      <ng-container matColumnDef="remove">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="app-mat-table-text-center cart-item-remove-cell"
        >
          Remove
        </th>
        <td
          mat-cell
          *matCellDef="let element"
          class="text-center cart-item-remove-cell"
        >
          <button (click)="remove(element)" mat-mini-fab color="warn">
            <mat-icon>clear</mat-icon>
          </button>
        </td>
      </ng-container>

      <!-- Footer -->
      <ng-container matColumnDef="first">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let transaction"></td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>

      <ng-container matColumnDef="second">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let transaction"></td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>

      <ng-container matColumnDef="trird">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let transaction"></td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>

      <ng-container matColumnDef="fourth">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let transaction"></td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>

      <ng-container matColumnDef="fifth">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let transaction"></td>
        <td
          colspan="2"
          mat-footer-cell
          *matFooterCellDef
          class="short-text text-right"
        >
          Total: <b>{{ total$ | async | currency }}</b>
        </td>
      </ng-container>

      <ng-container matColumnDef="sixth">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let transaction"></td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      <tr mat-footer-row *matFooterRowDef="displayedFooterColumns"></tr>
    </table>
  </ng-template>
</div>
